import{Q as k,a as R,b as D}from"./QSelect.2d0396a0.js";import{a as U,r as V,bf as $,R as j,S as T,_ as N,g as O,A as z,j as H,bg as K,C as E,$ as G,aA as J,bh as W,w as X,a2 as A,a3 as c,a7 as Q,ac as r,a8 as l,aH as q,ag as Y,ah as Z,ai as ee,a9 as p,af as g,aa as te}from"./index.7d081dc2.js";import{f as oe,Q as ae,b as L,a as h}from"./format.a151a50b.js";import{Q as le}from"./QPage.7fcd64c2.js";import{api as M}from"./axios.f80c9d8b.js";var ne=U({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(b,{slots:n,emit:y}){const x=H(),u=V(null);let v=0;const f=[];function C(t){const _=typeof t=="boolean"?t:b.noErrorFocus!==!0,w=++v,B=(s,d)=>{y("validation"+(s===!0?"Success":"Error"),d)},F=s=>{const d=s.validate();return typeof d.then=="function"?d.then(m=>({valid:m,comp:s}),m=>({valid:!1,comp:s,err:m})):Promise.resolve({valid:d,comp:s})};return(b.greedy===!0?Promise.all(f.map(F)).then(s=>s.filter(d=>d.valid!==!0)):f.reduce((s,d)=>s.then(()=>F(d).then(m=>{if(m.valid===!1)return Promise.reject(m)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return w===v&&B(!0),!0;if(w===v){const{comp:d,err:m}=s[0];if(m!==void 0&&console.error(m),B(!1,d),_===!0){const I=s.find(({comp:P})=>typeof P.focus=="function"&&K(P.$)===!1);I!==void 0&&I.comp.focus()}}return!1})}function i(){v++,f.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function o(t){t!==void 0&&E(t);const _=v+1;C().then(w=>{_===v&&w===!0&&(b.onSubmit!==void 0?y("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function e(t){t!==void 0&&E(t),y("reset"),G(()=>{i(),b.autofocus===!0&&b.noResetFocus!==!0&&a()})}function a(){J(()=>{if(u.value===null)return;const t=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),_=>_.tabIndex>-1);t!=null&&t.focus({preventScroll:!0})})}$(W,{bindComponent(t){f.push(t)},unbindComponent(t){const _=f.indexOf(t);_>-1&&f.splice(_,1)}});let S=!1;return j(()=>{S=!0}),T(()=>{S===!0&&b.autofocus===!0&&a()}),N(()=>{b.autofocus===!0&&a()}),Object.assign(x.proxy,{validate:C,resetValidation:i,submit:o,reset:e,focus:a,getValidationComponents:()=>f}),()=>O("form",{class:"q-form",ref:u,onSubmit:o,onReset:e},z(n.default))}});const se={class:"row items-center q-gutter-sm q-mb-md"},ie=r("div",{class:"text-h5 q-mb-md text-blue-10"},"Ingreso de Medicamentos",-1),ce={class:"q-mb-md col-md-12"},re={class:"row q-gutter-sm"},ue=r("legend",{class:"text-blue-10"},"Informaci\xF3n B\xE1sica del Comprador",-1),de=r("span",{class:"text-weight-bold"},"C\xF3digo: ",-1),fe=r("span",{class:"text-weight-bold"},"Nombre Medicamento: ",-1),me=r("span",{class:"text-weight-bold"},"Fabricante: ",-1),be=r("span",{class:"text-weight-bold"},"Fecha Vencimiento: ",-1),ve=r("span",{class:"text-weight-bold"},"Cantidad: ",-1),_e=r("span",{class:"text-weight-bold"},"Lote: ",-1),pe=r("span",{class:"text-weight-bold"},"Stock: ",-1),ge=r("span",{class:"text-weight-bold"},"Precio: ",-1),Se={__name:"ingresoMedicamentoPage",setup(b){const n=V({nombre_cliente:"",documento_cliente:"",telefono_cliente:"",correo_cliente:""});X(()=>[n.value.documento_cliente],async([i])=>{n.value.nombre_cliente="",n.value.telefono_cliente="",n.value.correo_cliente="",i&&await C()}),N(async()=>{await y()});const y=async()=>{await v()},x=V([]),u=V([]),v=async()=>{var i,o;try{const{data:e}=await M.get("clientes/");u.value=e.map(({documento_cliente:a})=>({value:a,label:a})),x.value=u.value}catch(e){console.warn((o=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:o.message)}},f=(i,o)=>{if(i===""){o(()=>{x.value=u.value});return}o(()=>{const e=i.toLowerCase();x.value=u.value.filter(a=>a.label.toLowerCase().includes(e))})},C=async()=>{var o,e;const{documento_cliente:i}=n.value;try{const{data:a}=await M.get(`clientes/${i}`);a&&(n.value.nombre_cliente=a.nombre_cliente,n.value.correo_cliente=a.correo_cliente,n.value.telefono_cliente=a.telefono_cliente)}catch(a){console.warn((e=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:e.message)}};return(i,o)=>(Q(),A(le,{padding:""},{default:c(()=>[r("div",se,[l(R,null,{default:c(()=>[l(k,{label:"Panel Administrativo"}),l(k,{label:"P\xE1gina de Ingreso de Medicamentos"})]),_:1})]),ie,l(ne,{class:"q-gutter-sm row"},{default:c(()=>[r("div",ce,[r("fieldset",re,[ue,l(D,{modelValue:n.value.documento_cliente,"onUpdate:modelValue":o[0]||(o[0]=e=>n.value.documento_cliente=e),label:"Documentos Cliente",options:x.value,"option-label":"label","option-value":"value","use-input":"","emit-value":"","map-options":"",outlined:"",filled:"",class:"col-xs-12 col-sm-12 col-md-3",dense:"","hide-bottom-space":"",clearable:"",onFilter:f},null,8,["modelValue","options"]),l(q,{modelValue:n.value.nombre_cliente,"onUpdate:modelValue":o[1]||(o[1]=e=>n.value.nombre_cliente=e),dense:"",outlined:"",filled:"",type:"text",label:"Nombre del Cliente",class:"col-xs-12 col-sm-12 col-md-3","hide-bottom-space":""},null,8,["modelValue"]),l(q,{modelValue:n.value.telefono_cliente,"onUpdate:modelValue":o[2]||(o[2]=e=>n.value.telefono_cliente=e),dense:"",outlined:"",filled:"",type:"text",label:"Tel\xE9fono",class:"col-xs-12 col-sm-12 col-md-2","hide-bottom-space":""},null,8,["modelValue"]),l(q,{modelValue:n.value.correo_cliente,"onUpdate:modelValue":o[3]||(o[3]=e=>n.value.correo_cliente=e),dense:"",outlined:"",filled:"",type:"text",label:"Correo",class:"col-xs-12 col-sm-12 col-md-3","hide-bottom-space":""},null,8,["modelValue"])])])]),_:1}),l(oe,{bordered:"",class:"q-mt-md"},{default:c(()=>[(Q(!0),Y(ee,null,Z(i.medicamentos,(e,a)=>(Q(),A(ae,{key:e.codigo,class:"bg-red-1 q-mb-md"},{default:c(()=>[l(L,null,{default:c(()=>[l(h,null,{default:c(()=>[de,p(g(e.codigo),1)]),_:2},1024),l(h,null,{default:c(()=>[fe,p(g(e.nombre_medicamento),1)]),_:2},1024),l(h,null,{default:c(()=>[me,p(g(e.fabricante),1)]),_:2},1024),l(h,null,{default:c(()=>[be,p(g(e.fecha_vencimiento),1)]),_:2},1024),l(h,null,{default:c(()=>[ve,p(g(e.cantidad),1)]),_:2},1024),l(h,null,{default:c(()=>[_e,p(g(e.lote),1)]),_:2},1024),l(h,null,{default:c(()=>[pe,p(g(e.stock),1)]),_:2},1024),l(h,null,{default:c(()=>[ge,p(g(e.precio),1)]),_:2},1024)]),_:2},1024),l(L,{side:""},{default:c(()=>[l(te,{icon:"delete",color:"red",onClick:S=>i.eliminarMedicamento(a)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}};export{Se as default};
